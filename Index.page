Title="Bluetooth Manager"
---
<?php
$btmName = 'bluetooth-manager';
$connectedDevices = [];

exec("bluetoothctl devices", $connectedDevices);
?>

<style>
    .btm-container {
        display: flex;
        flex-direction: column;
    }

        .btm-container row {
            flex: 1;
        }
</style>

<div class="btm-container">
    <div class="row">
        <ul>
            <?php
            foreach ($connectedDevices as $connectedDevice) {
                $device = (explode(" ", $connectedDevice));
                $deviceId = join("", (explode(":", $device[1])));
                $deviceName = $device[2];

                echo '<li>
                        <input type="radio" id="' . $deviceId . '" name="' . $deviceId . '" value="' . $deviceId . '" />
                        <label for="' . $deviceId . '">' . $deviceName . '</label>
                    </li>';
            }
            ?>
        </ul>
    </div>
    <div class="row">
        <button type="button" onclick="scan();">Scan</button>
        <button type="button" onclick="callFunctions();">Pair</button>
    </div>
    <div class="btm-output"></div>
</div>

<script>
    function scan() {
        $('div.spinner').show();

        $.get('/plugins/<?= $btmName ?>/include/Scan.php', (data) => {
            $('div.spinner').hide();

            $('.btm-output').html(data);
        });
    }

    function pair(id) {
        $('div.spinner').show();

        $.get(`/plugins/<?= $btmName ?>/include/Pair.php?id=${id}`, (data) => {
            $('div.spinner').hide();

            $('.btm-output').html(data);
        });
    }

    $(function() {

    });
</script>